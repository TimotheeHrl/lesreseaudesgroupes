{"version":3,"file":"ImageResize.cjs.js","sources":["../src/DefaultOptions.js","../src/modules/BaseModule.js","../src/modules/DisplaySize.js","../src/modules/Toolbar.js","../src/modules/Resize.js","../src/modules/AltAttribute.js","../src/ImageResize.js"],"sourcesContent":["export default {\n  modules: ['DisplaySize', 'Toolbar', 'Resize', 'AltAttribute'],\n  overlayStyles: {\n    position: 'absolute',\n    boxSizing: 'border-box',\n    border: '1px dashed #444'\n  },\n  handleStyles: {\n    position: 'absolute',\n    height: '12px',\n    width: '12px',\n    backgroundColor: 'white',\n    border: '1px solid #777',\n    boxSizing: 'border-box',\n    opacity: '0.80'\n  },\n  displayStyles: {\n    position: 'absolute',\n    font: '12px/1.0 Arial, Helvetica, sans-serif',\n    padding: '4px 8px',\n    textAlign: 'center',\n    backgroundColor: 'white',\n    color: '#333',\n    border: '1px solid #777',\n    boxSizing: 'border-box',\n    opacity: '0.80',\n    cursor: 'default'\n  },\n  toolbarStyles: {\n    position: 'absolute',\n    top: '-12px',\n    right: '0',\n    left: '0',\n    height: '0',\n    minWidth: '100px',\n    font: '12px/1.0 Arial, Helvetica, sans-serif',\n    textAlign: 'center',\n    color: '#333',\n    boxSizing: 'border-box',\n    cursor: 'default'\n  },\n  toolbarButtonStyles: {\n    display: 'inline-block',\n    width: '24px',\n    height: '24px',\n    background: 'white',\n    border: '1px solid #999',\n    verticalAlign: 'middle'\n  },\n  toolbarButtonSvgStyles: {\n    fill: '#444',\n    stroke: '#444',\n    strokeWidth: '2'\n  }\n}\n","export class BaseModule {\n  constructor(resizer) {\n    this.overlay = resizer.overlay\n    this.img = resizer.img\n    this.options = resizer.options\n    this.requestUpdate = resizer.onUpdate\n  }\n  /*\n        requestUpdate (passed in by the library during construction, above) can be used to let the library know that\n        you've changed something about the image that would require re-calculating the overlay (and all of its child\n        elements)\n\n        For example, if you add a margin to the element, you'll want to call this or else all the controls will be\n        misaligned on-screen.\n     */\n\n  /*\n        onCreate will be called when the element is clicked on\n\n        If the module has any user controls, it should create any containers that it'll need here.\n        The overlay has absolute positioning, and will be automatically repositioned and resized as needed, so you can\n        use your own absolute positioning and the 'top', 'right', etc. styles to be positioned relative to the element\n        on-screen.\n     */\n  onCreate = () => {}\n\n  /*\n        onDestroy will be called when the element is de-selected, or when this module otherwise needs to tidy up.\n\n        If you created any DOM elements in onCreate, please remove them from the DOM and destroy them here.\n     */\n  onDestroy = () => {}\n\n  /*\n        onUpdate will be called any time that the element is changed (e.g. resized, aligned, etc.)\n\n        This frequently happens during resize dragging, so keep computations light while here to ensure a smooth\n        user experience.\n     */\n  onUpdate = () => {}\n}\n","import { BaseModule } from './BaseModule'\n\nexport class DisplaySize extends BaseModule {\n  onCreate = () => {\n    // Create the container to hold the size display\n    this.display = document.createElement('div')\n\n    // Apply styles\n    Object.assign(this.display.style, this.options.displayStyles)\n\n    // Attach it\n    this.overlay.appendChild(this.display)\n  }\n\n  onDestroy = () => {}\n\n  onUpdate = () => {\n    if (!this.display || !this.img) {\n      return\n    }\n\n    const size = this.getCurrentSize()\n    this.display.innerHTML = size.join(' &times; ')\n    if (size[0] > 120 && size[1] > 30) {\n      // position on top of image\n      Object.assign(this.display.style, {\n        right: '4px',\n        bottom: '4px',\n        left: 'auto'\n      })\n    } else if (this.img.style.float == 'right') {\n      // position off bottom left\n      const dispRect = this.display.getBoundingClientRect()\n      Object.assign(this.display.style, {\n        right: 'auto',\n        bottom: '0px',\n        left: `-${dispRect.width + 4}px`\n      })\n    } else {\n      // position off bottom right\n      const dispRect = this.display.getBoundingClientRect()\n      Object.assign(this.display.style, {\n        right: `-${dispRect.width + 8}px`,\n        bottom: '0px',\n        left: 'auto'\n      })\n    }\n  }\n\n  getCurrentSize = () => [\n    this.img.width,\n    Math.round(\n      (this.img.width / this.img.naturalWidth) * this.img.naturalHeight\n    )\n  ]\n}\n","import IconAlignLeft from 'quill/assets/icons/align-left.svg'\nimport IconAlignCenter from 'quill/assets/icons/align-center.svg'\nimport IconAlignRight from 'quill/assets/icons/align-right.svg'\nimport { BaseModule } from './BaseModule'\n\nlet Parchment = {}\nlet FloatStyle = {}\nlet MarginStyle = {}\nlet DisplayStyle = {}\n\nexport class Toolbar extends BaseModule {\n  onCreate = (parchment) => {\n    // Initilize styles\n    Parchment = parchment\n    FloatStyle = new Parchment.Attributor.Style('float', 'float')\n    MarginStyle = new Parchment.Attributor.Style('margin', 'margin')\n    DisplayStyle = new Parchment.Attributor.Style('display', 'display')\n\n    // Setup Toolbar\n    this.toolbar = document.createElement('div')\n    Object.assign(this.toolbar.style, this.options.toolbarStyles)\n    this.overlay.appendChild(this.toolbar)\n\n    // Setup Buttons\n    this._defineAlignments()\n    this._addToolbarButtons()\n  }\n\n  // The toolbar and its children will be destroyed when the overlay is removed\n  onDestroy = () => {}\n\n  // Nothing to update on drag because we are are positioned relative to the overlay\n  onUpdate = () => {}\n\n  _defineAlignments = () => {\n    this.alignments = [\n      {\n        icon: IconAlignLeft,\n        apply: () => {\n          DisplayStyle.add(this.img, 'inline')\n          FloatStyle.add(this.img, 'left')\n          MarginStyle.add(this.img, '0 1em 1em 0')\n        },\n        isApplied: () => FloatStyle.value(this.img) == 'left'\n      },\n      {\n        icon: IconAlignCenter,\n        apply: () => {\n          DisplayStyle.add(this.img, 'block')\n          FloatStyle.remove(this.img)\n          MarginStyle.add(this.img, 'auto')\n        },\n        isApplied: () => MarginStyle.value(this.img) == 'auto'\n      },\n      {\n        icon: IconAlignRight,\n        apply: () => {\n          DisplayStyle.add(this.img, 'inline')\n          FloatStyle.add(this.img, 'right')\n          MarginStyle.add(this.img, '0 0 1em 1em')\n        },\n        isApplied: () => FloatStyle.value(this.img) == 'right'\n      }\n    ]\n  }\n\n  _addToolbarButtons = () => {\n    const buttons = []\n    this.alignments.forEach((alignment, idx) => {\n      const button = document.createElement('span')\n      buttons.push(button)\n      button.innerHTML = alignment.icon\n      button.addEventListener('click', () => {\n        // deselect all buttons\n        buttons.forEach((button) => (button.style.filter = ''))\n        if (alignment.isApplied()) {\n          // If applied, unapply\n          FloatStyle.remove(this.img)\n          MarginStyle.remove(this.img)\n          DisplayStyle.remove(this.img)\n        } else {\n          // otherwise, select button and apply\n          this._selectButton(button)\n          alignment.apply()\n        }\n        // image may change position; redraw drag handles\n        this.requestUpdate()\n      })\n      Object.assign(button.style, this.options.toolbarButtonStyles)\n      if (idx > 0) {\n        button.style.borderLeftWidth = '0'\n      }\n      Object.assign(\n        button.children[0].style,\n        this.options.toolbarButtonSvgStyles\n      )\n      if (alignment.isApplied()) {\n        // select button if previously applied\n        this._selectButton(button)\n      }\n      this.toolbar.appendChild(button)\n    })\n  }\n\n  _selectButton = (button) => {\n    button.style.filter = 'invert(20%)'\n  }\n}\n","import { BaseModule } from './BaseModule'\n\nexport class Resize extends BaseModule {\n  onCreate = () => {\n    // track resize handles\n    this.boxes = []\n\n    // add 4 resize handles\n    this.addBox('nwse-resize') // top left\n    this.addBox('nesw-resize') // top right\n    this.addBox('nwse-resize') // bottom right\n    this.addBox('nesw-resize') // bottom left\n\n    this.positionBoxes()\n  }\n\n  onDestroy = () => {\n    // reset drag handle cursors\n    this.setCursor('')\n  }\n\n  positionBoxes = () => {\n    const handleXOffset = `${-parseFloat(this.options.handleStyles.width) /\n      2}px`\n    const handleYOffset = `${-parseFloat(this.options.handleStyles.height) /\n      2}px`\n\n    // set the top and left for each drag handle\n    ;[\n      { left: handleXOffset, top: handleYOffset }, // top left\n      { right: handleXOffset, top: handleYOffset }, // top right\n      { right: handleXOffset, bottom: handleYOffset }, // bottom right\n      { left: handleXOffset, bottom: handleYOffset } // bottom left\n    ].forEach((pos, idx) => {\n      Object.assign(this.boxes[idx].style, pos)\n    })\n  }\n\n  addBox = (cursor) => {\n    // create div element for resize handle\n    const box = document.createElement('div')\n\n    // Star with the specified styles\n    Object.assign(box.style, this.options.handleStyles)\n    box.style.cursor = cursor\n\n    // Set the width/height to use 'px'\n    box.style.width = `${this.options.handleStyles.width}px`\n    box.style.height = `${this.options.handleStyles.height}px`\n\n    // listen for mousedown on each box\n    box.addEventListener('mousedown', this.handleMousedown, false)\n    // add drag handle to document\n    this.overlay.appendChild(box)\n    // keep track of drag handle\n    this.boxes.push(box)\n  }\n\n  handleMousedown = (evt) => {\n    // note which box\n    this.dragBox = evt.target\n    // note starting mousedown position\n    this.dragStartX = evt.clientX\n    // store the width before the drag\n    this.preDragWidth = this.img.width || this.img.naturalWidth\n    // set the proper cursor everywhere\n    this.setCursor(this.dragBox.style.cursor)\n    // listen for movement and mouseup\n    document.addEventListener('mousemove', this.handleDrag, false)\n    document.addEventListener('mouseup', this.handleMouseup, false)\n  }\n\n  handleMouseup = () => {\n    // reset cursor everywhere\n    this.setCursor('')\n    // stop listening for movement and mouseup\n    document.removeEventListener('mousemove', this.handleDrag)\n    document.removeEventListener('mouseup', this.handleMouseup)\n  }\n\n  handleDrag = (evt) => {\n    if (!this.img) {\n      // image not set yet\n      return\n    }\n    // update image size\n    const deltaX = evt.clientX - this.dragStartX\n    if (this.dragBox === this.boxes[0] || this.dragBox === this.boxes[3]) {\n      // left-side resize handler; dragging right shrinks image\n      this.img.width = Math.round(this.preDragWidth - deltaX)\n    } else {\n      // right-side resize handler; dragging right enlarges image\n      this.img.width = Math.round(this.preDragWidth + deltaX)\n    }\n    this.requestUpdate()\n  }\n\n  setCursor = (value) => {\n    ;[document.body, this.img].forEach((el) => {\n      el.style.cursor = value // eslint-disable-line no-param-reassign\n    })\n  }\n}\n","import { BaseModule } from './BaseModule'\n\nexport class AltAttribute extends BaseModule {\n  onCreate = () => {\n    // Create the container to hold the input element\n    this.display = document.createElement('div')\n\n    // Apply styles\n    Object.assign(this.display.style, this.options.displayStyles)\n\n    // Attach it\n    this.overlay.appendChild(this.display)\n\n    // ALT input\n    this.altInput = document.createElement('input')\n    if (this.img.alt) {\n      // Set default value into the input\n      this.altInput.value = this.img.alt\n    }\n    this.altInput.addEventListener('input', this.onAltInputChange)\n\n    this.display.insertAdjacentHTML('beforeend', 'Alt: ')\n    this.display.appendChild(this.altInput)\n  }\n\n  onAltInputChange = (e) => {\n    this.img.alt = e.target.value\n    this.img.title = e.target.value\n  }\n\n  onDestroy = () => {\n    this.altInput.removeEventListener('input', this.onAltInputChange)\n  }\n\n  onUpdate = () => {\n    if (!this.display || !this.img) {\n      return\n    }\n\n    Object.assign(this.display.style, {\n      right: 'auto',\n      bottom: '-40px',\n      left: '8px',\n      'min-width': '172px',\n    })\n  }\n\n  getCurrentSize = () => [\n    this.img.width,\n    Math.round(\n      (this.img.width / this.img.naturalWidth) * this.img.naturalHeight\n    ),\n  ]\n}\n","import defaultsDeep from 'lodash/defaultsDeep'\nimport DefaultOptions from './DefaultOptions'\nimport { DisplaySize } from './modules/DisplaySize'\nimport { Toolbar } from './modules/Toolbar'\nimport { Resize } from './modules/Resize'\nimport { AltAttribute } from './modules/AltAttribute'\n\nconst knownModules = { DisplaySize, Toolbar, Resize, AltAttribute }\n\n/**\n * Custom module for quilljs to allow user to resize <img> elements\n * (Works on Chrome, Edge, Safari and replaces Firefox's native resize behavior)\n * @see https://quilljs.com/blog/building-a-custom-module/\n */\nexport default class ImageResize {\n  constructor(quill, options = {}) {\n    // save the quill reference and options\n    this.quill = quill\n\n    // Apply the options to our defaults, and stash them for later\n    // defaultsDeep doesn't do arrays as you'd expect, so we'll need to apply the classes array from options separately\n    let moduleClasses = false\n    if (options.modules) {\n      moduleClasses = options.modules.slice()\n    }\n\n    if (options.parchment) {\n      this.parchment = options.parchment\n    }\n\n    // Apply options to default options\n    this.options = defaultsDeep({}, options, DefaultOptions)\n\n    // (see above about moduleClasses)\n    if (moduleClasses !== false) {\n      this.options.modules = moduleClasses\n    }\n\n    // disable native image resizing on firefox\n    document.execCommand('enableObjectResizing', false, 'false')\n\n    // respond to clicks inside the editor\n    this.quill.root.addEventListener('click', this.handleClick, false)\n\n    this.quill.root.parentNode.style.position =\n      this.quill.root.parentNode.style.position || 'relative'\n\n    // setup modules\n    this.moduleClasses = this.options.modules\n\n    this.modules = []\n  }\n\n  initializeModules = () => {\n    this.removeModules()\n\n    this.modules = this.moduleClasses.map(\n      (ModuleClass) => new (knownModules[ModuleClass] || ModuleClass)(this)\n    )\n\n    this.modules.forEach((module) => {\n      module.onCreate(this.parchment)\n    })\n\n    this.onUpdate()\n  }\n\n  onUpdate = () => {\n    this.repositionElements()\n    this.modules.forEach((module) => {\n      module.onUpdate()\n    })\n  }\n\n  removeModules = () => {\n    this.modules.forEach((module) => {\n      module.onDestroy()\n    })\n\n    this.modules = []\n  }\n\n  handleClick = (evt) => {\n    if (\n      evt.target &&\n      evt.target.tagName &&\n      evt.target.tagName.toUpperCase() === 'IMG'\n    ) {\n      if (this.img === evt.target) {\n        // we are already focused on this image\n        return\n      }\n      if (this.img) {\n        // we were just focused on another image\n        this.hide()\n      }\n      // clicked on an image inside the editor\n      this.show(evt.target)\n    } else if (this.img) {\n      // clicked on a non image\n      this.hide()\n    }\n  }\n\n  show = (img) => {\n    // keep track of this img element\n    this.img = img\n\n    this.showOverlay()\n\n    this.initializeModules()\n  }\n\n  showOverlay = () => {\n    if (this.overlay) {\n      this.hideOverlay()\n    }\n\n    this.quill.setSelection(null)\n\n    // prevent spurious text selection\n    this.setUserSelect('none')\n\n    // listen for the image being deleted or moved\n    document.addEventListener('keyup', this.checkImage, true)\n    this.quill.root.addEventListener('input', this.checkImage, true)\n\n    // Create and add the overlay\n    this.overlay = document.createElement('div')\n    Object.assign(this.overlay.style, this.options.overlayStyles)\n\n    this.quill.root.parentNode.appendChild(this.overlay)\n\n    this.repositionElements()\n  }\n\n  hideOverlay = () => {\n    if (!this.overlay) {\n      return\n    }\n\n    // Remove the overlay\n    this.quill.root.parentNode.removeChild(this.overlay)\n    this.overlay = undefined\n\n    // stop listening for image deletion or movement\n    document.removeEventListener('keyup', this.checkImage)\n    this.quill.root.removeEventListener('input', this.checkImage)\n\n    // reset user-select\n    this.setUserSelect('')\n  }\n\n  repositionElements = () => {\n    if (!this.overlay || !this.img) {\n      return\n    }\n\n    // position the overlay over the image\n    const parent = this.quill.root.parentNode\n    const imgRect = this.img.getBoundingClientRect()\n    const containerRect = parent.getBoundingClientRect()\n\n    Object.assign(this.overlay.style, {\n      left: `${imgRect.left - containerRect.left - 1 + parent.scrollLeft}px`,\n      top: `${imgRect.top - containerRect.top + parent.scrollTop}px`,\n      width: `${imgRect.width}px`,\n      height: `${imgRect.height}px`\n    })\n  }\n\n  hide = () => {\n    this.hideOverlay()\n    this.removeModules()\n    this.img = undefined\n  }\n\n  setUserSelect = (value) => {\n    ;[\n      'userSelect',\n      'mozUserSelect',\n      'webkitUserSelect',\n      'msUserSelect'\n    ].forEach((prop) => {\n      // set on contenteditable element and <html>\n      this.quill.root.style[prop] = value\n      document.documentElement.style[prop] = value\n    })\n  }\n\n  checkImage = (evt) => {\n    if (this.img) {\n      if (\n        document.activeElement.tagName === 'BODY' &&\n        (evt.code === 46 ||\n          evt.code === 8 ||\n          evt.keyCode === 46 ||\n          evt.keyCode === 8)\n      ) {\n        const imageNode = window.Quill.find(this.img)\n        if (imageNode) {\n          imageNode.deleteAt(0)\n        }\n        this.hide()\n      }\n    }\n  }\n}\n"],"names":["modules","overlayStyles","position","boxSizing","border","handleStyles","height","width","backgroundColor","opacity","displayStyles","font","padding","textAlign","color","cursor","toolbarStyles","top","right","left","minWidth","toolbarButtonStyles","display","background","verticalAlign","toolbarButtonSvgStyles","fill","stroke","strokeWidth","BaseModule","resizer","overlay","img","options","requestUpdate","onUpdate","DisplaySize","document","createElement","Object","assign","style","appendChild","size","getCurrentSize","innerHTML","join","bottom","dispRect","getBoundingClientRect","Math","round","naturalWidth","naturalHeight","Parchment","FloatStyle","MarginStyle","DisplayStyle","Toolbar","parchment","Attributor","Style","toolbar","_defineAlignments","_addToolbarButtons","alignments","icon","IconAlignLeft","apply","add","isApplied","value","IconAlignCenter","remove","IconAlignRight","buttons","forEach","alignment","idx","button","push","addEventListener","filter","_selectButton","borderLeftWidth","children","Resize","boxes","addBox","positionBoxes","setCursor","handleXOffset","parseFloat","handleYOffset","pos","box","handleMousedown","evt","dragBox","target","dragStartX","clientX","preDragWidth","handleDrag","handleMouseup","removeEventListener","deltaX","body","el","AltAttribute","altInput","alt","onAltInputChange","insertAdjacentHTML","e","title","knownModules","ImageResize","quill","removeModules","moduleClasses","map","ModuleClass","module","onCreate","repositionElements","onDestroy","tagName","toUpperCase","hide","show","showOverlay","initializeModules","hideOverlay","setSelection","setUserSelect","checkImage","root","parentNode","removeChild","undefined","parent","imgRect","containerRect","scrollLeft","scrollTop","prop","documentElement","activeElement","code","keyCode","imageNode","window","Quill","find","deleteAt","slice","defaultsDeep","DefaultOptions","execCommand","handleClick"],"mappings":"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"}